<div class="container">
  <div class="recipe-header">
    <h1><%= @recipe.name %></h1>
  </div>
    <div class="recipe-img">
      <%= image_tag(@recipe.image_url) %>
        <%= link_to like_recipe_path(@recipe), remote: true, method: :post do %>
          <i class="fa fa-solid fa-heart<%= " red" if current_user.favorited?(@recipe) %>"></i>
        <% end %>
    </div>
    <div class="recipe-card-links">
      <div class="recipe-time">
        <p> Total Time: <%= @recipe.cooking_time %> minutes </p>
          <ul class="recipe-stars"> <% 5.times do |x| %>
            <% if x < @recipe.rating %>
              <li class="fa fa-star checked"> </li>
            <% else %>
              <li class="fa fa-star"> </li>
            <% end %>
           <% end %>
          </ul>
      </div>

      <% dates = [] %>
        <% 20.times do |i| %>
        <% dates << ((Date.today + i).strftime("%d")).to_i %>
      <% end %>

      <% day = [] %>
        <% 20.times do |i| %>
        <% day << ((Date.today + i).strftime("%a")) %>
      <% end %>

        <div class="recipe-cal-btn">
        <button type="button" class="btn btn-outline-success mb-3" data-bs-toggle="modal" data-bs-target="#exampleModal"> Add to Calendar </button>
          <div class="modal" id="exampleModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header justify-content-center">
                  <h5 class="modal-title"> Calendar </h5>
                </div>

                <div class="modal-body">
                  <div id="multi-item-example" class="carousel slide carousel-multi-item" data-bs-ride="carousel" data-bs-interval="false">
                    <div class="carousel-inner" role="listbox">
                      <div class="carousel-item active">


                        <div class="row">
                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[0] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe, date: dates[0], day: day[0]), method: :post do %>
                                <% unless @meal_plan[0].nil? %>
                                  <%= image_tag(Recipe.find(@meal_plan[0].recipe_id).image_url) %>
                                <% end %>
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[0] %></p>
                              </div>
                            </div>
                          </div>

                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[1] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[1] %></p>
                              </div>
                            </div>
                          </div>

                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[2] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[2] %></p>
                              </div>
                            </div>
                          </div>


                        </div>
                      </div>


                      <div class="carousel-item">


                        <div class="row">
                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[3] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[3] %></p>
                              </div>
                            </div>
                          </div>

                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[4] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[4] %></p>
                              </div>
                            </div>
                          </div>

                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[5] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[5] %></p>
                              </div>
                            </div>
                          </div>


                        </div>
                      </div>

                      <div class="carousel-item">


                        <div class="row">
                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[6] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[6] %></p>
                              </div>
                            </div>
                          </div>

                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[7] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[7] %></p>
                              </div>
                            </div>
                          </div>

                          <div class="col-4">
                            <div class="cal-card my-2">
                              <div class="cal-card-title">
                                <p><%= dates[8] %></p>
                              </div>
                              <div class="cal-card-img">
                              <%= link_to recipe_meal_plans_path(@recipe), method: :post do %>
                                <img src="" alt="">
                              <% end %>
                              </div>
                              <div class="cal-card-day">
                                <p><%= day[8] %></p>
                              </div>
                            </div>
                          </div>


                        </div>
                      </div>

                      <button class="carousel-control-prev" type="button" data-bs-target="#multi-item-example" data-bs-slide="prev">
                        <i class="carousel-control-prev-icon fa fa-solid fa-angle-left"></i>
                        <span class="visually-hidden">Previous</span>
                      </button>
                      <button class="carousel-control-next" type="button" data-bs-target="#multi-item-example" data-bs-slide="next">
                        <i class="carousel-control-next-icon fa fa-solid fa-angle-right"></i>
                        <span class="visually-hidden">Next</span>
                      </button>
                    </div>
                  </div>
                </div>

                <div class="modal-footer justify-content-between">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-outline-success">Confirm</button>
                </div>
              </div>
            </div>
          </div>
        </div>

    </div>
      <div class="recipe-ing-sub-card">
        <div class="recipe-ing">
          <h4>Ingredients:</h4>
          <ul class="recipe-ing-li">
          <% @recipe.ingredients.each do |r| %>
            <li><%= r.name %></li>
          <% end %>
          </ul>
        </div>
        <div class="recipe-sub">
          <h4>Substitutes:</h4>
            <ul class="recipe-sub-li">
              <% @recipe.method.gsub("[", "").gsub("]", "").gsub(/\\/, "").split("\",").each do |sub| %>
                <li><%= sub.gsub("\"", "") if sub.include?("?") %></li>
              <% end %>
            </ul>
        </div>
      </div>
      <br>
        <div class="recipe-desc">
          <h4>Description:</h4>
          <p><%= @recipe.description %></p>
        </div>
        <br>
          <div class="recipe-meth">
            <h4>Recipe:</h4>
              <ul>
                <% @recipe.method.gsub("[", "").gsub("]", "").gsub(/\\/, "").split("\",").each do |sub| %>
                  <% unless sub.include?("?") %>
                    <li><%= sub.gsub("\"", "") %></li>
                  <% end %>
                <% end %>
              </ul>
          </div>
          <br>
            <div class="recipe-stor">
              <h4>How to Store:</h4>
              <p><%= @recipe.storage %></p>
            </div>
            <br>
              <div class="recipe-leftover">
                <h4>Leftovers:</h4>
                <p><%= @recipe.leftover %></p>
              </div>
              <br>
                <div class="recipe-review-btn">
                  <%= link_to "Leave a review", new_recipe_review_path(@recipe), class: "btn btn-outline-success mb-3 mx-2" %>
                </div>
</div>
